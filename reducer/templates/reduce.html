{% load static %}
<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="generator" content="">
    <title>URL Reduce</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
    <!-- Bootstrap core CSS -->

    <link href="{% static 'reducer/assets/css/style.css' %}" rel="stylesheet">
  </head>
  <body class="text-center">
    <div class="container">
      <div class="row">
        <div class="offset-sm-1 col-sm-10">
          <h1 class="font-weight-bold">URL<span class="font-weight-light color-y">Reduce</span></h1>
          <p class="h5 mb-5 text-muted">URL Reduce</p>

        </div>
      </div>

      <div class="row">
        <div class="offset-sm-1 col-sm-10 text-left text-muted">
          <p>Create in {% now "d F \o\f Y, H:i\H e"%}</p>
          <h5>Original: <a href="{{ reduce.destiny }}" class="color-y">{{ reduce.destiny }}</a></h5>
        </div>
      </div>

      <div class="row">
        <div class="offset-sm-1 col-sm-10 text-left text-muted">
          <h3>Reduced: <a href="{{ url_reduced }}" class="color-y">{{ url_reduced }}</a></h3>
        </div>
      </div>

      <div class="row">
        <div class="offset-sm-1 col-sm-10 text-left">
          <button class="btn btn-outline-primary">COPY</button>
          <button class="btn btn-outline-primary">SHARE</button>
        </div>
      </div>

      <h2 class="font-weight-bold mt-5">Total Clicks: <span class="color-y">{{ total_clicks }}</span></h2>
      <p class="text-muted">Graph Clicks per Day</p>
      <div class="row mt-3">
        <div class="offset-sm-1 col-sm-10">

          <!-- Gr치fico -->
          <div class="card">
              <canvas id="multipleBarChart"></canvas>
          </div>
          <!-- Gr치fico -->

        </div>
      </div>

      <div class="row">
        <div class="offset-sm-1 col-sm-10 mt-5">

            <!-- Tabela -->
            <div class="panel">
                <div class="panel-heading">
                    <h3 class="panel-title font-weight-bold mb-3">Clicks per Day</h3>
                </div>
                    <div class="panel-body">
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th class="text-left">Day of Week</th>
                                        <th>Total Clicks</th>
                                    </tr>
                                </thead>
                                <tbody>
                                {% for r in redirects_date %}
                                    <tr title="Total Clicks in {{ r.date }}">
                                        <td class="text-left">{{ r.date }}</td>
                                        <td>{{ r.clicks }}</td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
            </div>
            <!-- Tabela -->

        </div>
    </div>

      <p class="mt-5 text-muted"><span class="color-y">&copy;</span> 2021 - Jornada Rumo a Primeira Vaga | URL<span class="color-y">Reduce</span></p>
      <br />
    </div>

    <!-- Bootstrap core JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Bootstrap core JS -->

    <!-- Lib Chart JS -->
    <script src="{% static 'reducer/assets/js/chart.js/chart.min.js' %}"></script>
    <!-- Lib Chart JS -->

    <!-- Gr치fico -->
    <script>
      let multipleBarChart = document.getElementById('multipleBarChart').getContext('2d')

      let myMultipleBarChart = new Chart(multipleBarChart, {
          type: 'bar',

          // Como usar a Lib ChartJS com Django -> https://medium.com/code-rocket-blog/trabalhando-com-gr%C3%A1ficos-no-django-usando-chart-js-495aa6abbe0f

          data: {
              labels: [
                  {% for r in redirects_date %}
                      {{ r.data }},
                  {% endfor %}
              ],
              datasets: [{
                  label: "Total Clicks per Day",
                  backgroundColor: '#005490',
                  borderColor: '#005490',
                  data: [
                      {% for r in redirects_date %}
                        {{ r.clicks }},
                      {% endfor %}
                  ],
              }],
          },
          options: {
              responsive: true,
              maintainAspectRatio: false,
              legend: {
                  position: 'bottom'
              },
              title: {
                  display: true,
                  //text: 'Graph Clicks per Day'
              },
              tooltips: {
                  mode: 'index',
                  intersect: false
              },
              responsive: true,
              scales: {
                  xAxes: [{
                      stacked: true,
                  }],
                  yAxes: [{
                      stacked: true
                  }]
              }
          }
      });
    </script>
    <!-- Gr치fico -->
  </body>
</html>